C51 COMPILER V9.00   XFS5152                                                               09/21/2013 09:38:13 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE XFS5152
OBJECT MODULE PLACED IN ..\obj\XFS5152.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\user\XFS5152.C BROWSE INCDIR(..\code;..\user) DEBUG OBJECTEXTEND PRINT(.
                    -.\obj\XFS5152.lst) OBJECT(..\obj\XFS5152.obj)

line level    source

   1          /***************************飞音云电子****************************
   2          **  工程名称：YS-XFS5152语音合成配套程序
   3          **      CPU: STC89LE52
   4          **      晶振：22.1184MHZ
   5          **      波特率：9600 bit/S
   6          **      配套产品信息：YS-XFS5051语音合成模块
   7          **                http://yuesheng001.taobao.com
   8          **  作者：zdings
   9          **  联系：751956552@qq.com
  10          **  修改日期：2012.12.23
  11          **  说明：用户在使用程序时，只需要编写好 串口发送函数PrintCom()；即可，
  12                   直接调用本文件进行播放即可，在编写程序时，注意判断语音合成模
  13                                           块的返回值，根据返回值进行下一次播放，如不接收返回值则无法进
  14                                           行下一次播放。
  15          /***************************飞音云电子******************************/
  16          
  17          #include "config.h"
  18          
  19          
  20          
  21          /**************芯片设置命令*********************/
  22          uint8_t XFS_StopCom[]={0xFD,0X00,0X01,0X02};//停止合成
  23          uint8_t XFS_SuspendCom[]={0XFD,0X00,0X01,0X03};//暂停合成
  24          uint8_t XFS_RecoverCom[]={0XFD,0X00,0X01,0X04};//恢复合成
  25          uint8_t XFS_ChackCom[]={0XFD,0X00,0X01,0X21};//状态查询
  26          uint8_t XFS_PowerDownCom[]={0XFD,0X00,0X01,0X88};//进入POWER DOWN 状态命令
  27          
  28          /***********************************************/
  29          
  30          
  31          
  32          /***********************************************************
  33          * 名    称：  YS-XFS5051 文本合成函数
  34          * 功    能：  发送合成文本到XFS5051芯片进行合成播放
  35          * 入口参数：  *HZdata:文本指针变量 
  36          * 出口参数：
  37          * 说    明： 本函数只用于文本合成，具备背景音乐选择。默认波特率9600bps。                                         
  38          * 调用方法：例： SYN_FrameInfo（“飞音云电子”）；
  39          **********************************************************/
  40          void XFS_FrameInfo(uint8_t *HZdata)
  41          {
  42   1      /****************需要发送的文本**********************************/ 
  43   1                       unsigned  char xdata Frame_Info[50]; //定义的文本长度
  44   1               unsigned  int  HZ_Length;  
  45   1      
  46   1                   unsigned  int i=0; 
  47   1                       HZ_Length =strlen(HZdata);                     //需要发送文本的长度
  48   1                       
  49   1      /*****************帧固定配置信息**************************************/           
  50   1                       Frame_Info[0] = 0xFD ;                         //构造帧头FD
  51   1                       Frame_Info[1] = 0x00 ;                         //构造数据区长度的高字节
  52   1                       Frame_Info[2] = HZ_Length+2;           //构造数据区长度的低字节
  53   1                       Frame_Info[3] = 0x01 ;                         //构造命令字：合成播放命令                               
  54   1                       Frame_Info[4] = 0x01;       //文本编码格式：GBK 
C51 COMPILER V9.00   XFS5152                                                               09/21/2013 09:38:13 PAGE 2   

  55   1       
  56   1      /*******************发送帧信息***************************************/            
  57   1               memcpy(&Frame_Info[5], HZdata, HZ_Length);
  58   1                       PrintCom(Frame_Info,5+HZ_Length); //发送帧配置
  59   1      }
  60          
  61          
  62          /***********************************************************
  63          * 名    称： void  main(void)
  64          * 功    能： 主函数     程序入口
  65          * 入口参数： *Info_data:固定的配置信息变量 
  66          * 出口参数：
  67          * 说    明：本函数用于配置，停止合成、暂停合成等设置 ，默认波特率9600bps。                                       
  68          * 调用方法：通过调用已经定义的相关数组进行配置。 
  69          **********************************************************/
  70          void YS_XFS_Set(uint8_t *Info_data)
  71          {
  72   1              uint8_t Com_Len;
  73   1              Com_Len =strlen(Info_data);
  74   1              PrintCom(Info_data,Com_Len);
  75   1      }
  76          
  77          
  78          
  79          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     86    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      50
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20      10
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
